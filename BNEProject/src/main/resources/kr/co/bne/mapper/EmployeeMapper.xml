<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
    PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
    "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="kr.co.bne.mapper.Employee">

	<select id="selectEmployee" parameterType="String" resultType="Employee">
   <![CDATA[select e.*, d.department_name,
        CASE WHEN employee_id in (select manager_id from department) THEN 'manager'
        ELSE 'employee' END position from employee e, department d where e.DEPARTMENT_ID = d.DEPARTMENT_ID
        and employee_id = #{value}]]>
   </select>

	<update id="updatePassword" parameterType="HashMap">
	<![CDATA[update employee set password=#{password} where employee_id=#{id}]]>
	</update>
	
	<update id="updateFile" parameterType="HashMap">
	<![CDATA[update employee set file_position=#{filePosition} where employee_id=#{id}]]>
	</update>

	<update id="defaultUpdateFile" parameterType="String">
	<![CDATA[update employee set file_position='default.png' where employee_id=#{value}]]>
	</update>

	<select id="selectImage" resultType="Employee">
	<![CDATA[select employee_name,file_position from employee where employee_id='1'	]]>
	</select>
	
	<select id="empSearch" parameterType="String" resultType="Employee">
		<![CDATA[
			select e.EMPLOYEE_ID, e.EMPLOYEE_NAME, e.DEPARTMENT_ID, e.mobile_phone, e.email, e.file_position,
			       CASE WHEN employee_id in (select manager_id from department) THEN 'manager'
			       ELSE 'employee' END position
			from employee e, department d
			where e.DEPARTMENT_ID = d.DEPARTMENT_ID
			  and EMPLOYEE_NAME like #{value}
			order by 2	]]>
	</select>

	<select id="selectTeamMember" resultType="Employee" parameterType="Integer">
	<![CDATA[select employee_name,employee_id from employee where department_id=#{values}]]>
	</select>

</mapper>